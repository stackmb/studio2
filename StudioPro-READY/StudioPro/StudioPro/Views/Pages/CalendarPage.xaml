<Page
    x:Class="RomanticStudio.Views.Pages.CalendarPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    FlowDirection="RightToLeft">

    <Grid Padding="25">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="ðŸ“… ØªÙ‚ÙˆÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§" Style="{StaticResource TitleTextBlock}"/>
        </Grid>

        <!-- Calendar Controls -->
        <Border Grid.Row="1" Style="{StaticResource CardBorder}" Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="PreviousMonthButton" Grid.Column="0" 
                        Click="PreviousMonthButton_Click"
                        Style="{StaticResource IconButton}">
                    <FontIcon Glyph="&#xE76B;"/>
                </Button>

                <StackPanel Grid.Column="1" Orientation="Horizontal" 
                           HorizontalAlignment="Center" Spacing="15">
                    <TextBlock x:Name="MonthYearText" Text="ÙØ±ÙˆØ±Ø¯ÛŒÙ† 1404" 
                              FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
                    <Button x:Name="TodayButton" Content="Ø§Ù…Ø±ÙˆØ²" 
                           Click="TodayButton_Click"/>
                </StackPanel>

                <Button x:Name="NextMonthButton" Grid.Column="2" 
                        Click="NextMonthButton_Click"
                        Style="{StaticResource IconButton}">
                    <FontIcon Glyph="&#xE76C;"/>
                </Button>
            </Grid>
        </Border>

        <!-- Calendar Grid -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Calendar -->
            <Border Grid.Column="0" Style="{StaticResource CardBorder}" Margin="0,0,10,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Day Headers -->
                    <Grid Grid.Row="0" Height="40">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Ø´" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="1" Text="ÛŒ" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="2" Text="Ø¯" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="3" Text="Ø³" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="4" Text="Ú†" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="5" Text="Ù¾" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="6" Text="Ø¬" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="Red"/>
                    </Grid>

                    <!-- Days Grid -->
                    <ItemsRepeater Grid.Row="1" ItemsSource="{x:Bind CalendarDays, Mode=OneWay}">
                        <ItemsRepeater.Layout>
                            <UniformGridLayout MinItemWidth="60" MinItemHeight="60" MaximumRowsOrColumns="7"/>
                        </ItemsRepeater.Layout>
                        <ItemsRepeater.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{Binding IsToday}" 
                                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                       BorderThickness="1" Margin="2" CornerRadius="8"
                                       Visibility="{Binding DayVisibility}">
                                    <Grid>
                                        <TextBlock Text="{Binding DayText}" 
                                                  FontSize="16" 
                                                  HorizontalAlignment="Center" 
                                                  VerticalAlignment="Center"/>
                                        
                                        <Border Background="OrangeRed" CornerRadius="10" 
                                               Width="20" Height="20"
                                               HorizontalAlignment="Left" VerticalAlignment="Top"
                                               Margin="5" Visibility="{Binding EventBadgeVisibility}">
                                            <TextBlock Text="{Binding EventCountText}" 
                                                      Foreground="White" FontSize="11" 
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsRepeater.ItemTemplate>
                    </ItemsRepeater>
                </Grid>
            </Border>

            <!-- Events List -->
            <Border Grid.Column="1" Style="{StaticResource CardBorder}">
                <StackPanel Spacing="15">
                    <TextBlock Text="Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø§Ù‡" Style="{StaticResource SubtitleTextBlock}"/>
                    
                    <ListView ItemsSource="{x:Bind Events, Mode=OneWay}" SelectionMode="None">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                                       CornerRadius="8" Padding="12" Margin="0,0,0,8">
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="{Binding Title}" FontWeight="SemiBold" FontSize="14"/>
                                        <TextBlock Text="{Binding DateFormatted}" FontSize="12" 
                                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                        <TextBlock Text="{Binding PhoneNumber}" FontSize="12" 
                                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Page>
